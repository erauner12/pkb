{"children":[{"children":[],"uri":"https://www.notion.so/e0241dbedd344c488f6c3e70425e2d35","type":"text","createdTime":1601294220000,"lastEditedTime":1601294220000,"title":[]},{"children":[],"uri":"https://www.notion.so/c7a569b373c7447ea087f0f4886f30cc","type":"code","createdTime":1601294256871,"lastEditedTime":1601294220000,"title":[["def stack = \"chart\"\ndef domain = \"m0657\"\ndef client = \"yava_az\"\ndef phaseOne = true\ndef phase = \"1\"\n\nif (phaseOne != true){\n    phase = \"\"\n}\ndef csv = new StringReader('''FQDN,Client,VIP,DNS,Servers,Datacenter,Group,Ports,Phase,DomainType,SSSD,GlobalName\nm0657.yava_az.cernerasp.com,,,,yavaazsync09.cernerasp.com,ls5,chart,,1,non-prod,true,\nm0657.yava_az.cernerasp.com,,,,yavaazsync10.cernerasp.com,ls5,mplus,,1,non-prod,true,\nm0657.yava_az.cernerasp.com,,,,yavaazsync10.cernerasp.com,ls5,nursing,,1,non-prod,true,\n''')\n\n\ndef headers=null\ncsv.splitEachLine(','){line->\n    //remove spaces\n    line=line.collect{it.trim()}\n    if(headers==null){\n        //convert headers array to [name:index] map\n        //csvFile.each { line ->\n        count = 0\n        def headerMapList = []\n        line.each { l ->\n            def headerMap = [:]\n            headerMap.putAt(l, count)\n            headerMapList << headerMap\n            count = count + 1\n        }\n        count = 0\n        def allMaps = [:]\n        headerMapList.each { m ->\n        tmpVar = m.keySet()\n            def array = []\n            tmpVar.each { a ->\n                array << a\n            }\n            def headerMap = [:]\n            headerMap = [:]\n            tmp = tmpVar[0]\n            headerMap.put(tmp, count)\n            allMaps << headerMap\n            count++\n        }\n        headers = allMaps\n        //the key needs to be FQDN and the value can be count ++\n    }else{\n        //print line only when you have a valid value in line\n\n\n        if( line[headers['Group']] = \"${stack}\" ){\n            fqdnIndex = headers['FQDN']\n            serversIndex = headers['Servers']\n            datacenterIndex = headers['Datacenter']\n            groupIndex = headers['Group']\n            phaseIndex = headers['Phase']\n            domainIndex = headers['DomainType']\n\n            def tmpMap = [:]\n            tmpMap.putAt(\"FQDN\", line[fqdnIndex])\n            tmpMap.putAt(\"Servers\", line[serversIndex])\n            tmpMap.putAt(\"Datacenter\", line[datacenterIndex])\n            tmpMap.putAt(\"Group\", line[groupIndex])\n            tmpMap.putAt(\"Phase\", line[phaseIndex])\n            tmpMap.putAt(\"DomainType\", line[domainIndex])\n            \n            if ( phaseOne == true ){\n            tmpMap.putAt(\"Phase\", \"1\")\n            }\n            //println tmpMap\n            return tmpMap\n        }\n    }\n}"]],"language":"Groovy","wrap":false},{"children":[],"uri":"https://www.notion.so/41e00f9b1d7b499d861eb08a8aa43338","type":"text","createdTime":1601294220000,"lastEditedTime":1601294220000,"title":[]}],"uri":"https://www.notion.so/dd8d9f2cde854eb286ea1342e221c6b1","type":"page","createdTime":1601293920000,"lastEditedTime":1601294220000,"title":[["g"]],"fullWidth":false,"coverPosition":1,"properties":{":H`m":[["Yes"]],"C'lP":[["Yes"]],"|Ay0":[["post"]],"title":[["g"]]}}