---
title: "result"
--- 
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kubernetes</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="EVAN-PC" />
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<script> var HS_STARTUP_FOLDED = true; </script>
</head>
<body>
<div id="content">
<h1 class="title">Kubernetes</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org1c005b0">1. Links</a></li>
<li><a href="#org217a8de">2. Vagrant Lab</a></li>
<li><a href="#org994f280">3. Course Overview</a>
<ul>
<li><a href="#orgf0edb3d">3.1. Course Introduction</a></li>
</ul>
</li>
<li><a href="#org3e875b1">4. Course Introduction</a>
<ul>
<li><a href="#orga99cebf">4.1. Course intro</a></li>
</ul>
</li>
<li><a href="#org03ba636">5. What Is Kubernetes?</a>
<ul>
<li><a href="#orgd971d28">5.1. Kubernetes: Where It Came From</a></li>
<li><a href="#org08f2fc6">5.2. Kubernetes: What and Why</a></li>
</ul>
</li>
<li><a href="#org89ac11a">6. Kubernetes Architecture</a>
<ul>
<li><a href="#org4652346">6.1. Module Intro</a></li>
<li><a href="#orgcfc4760">6.2. Big Picture View</a></li>
<li><a href="#org74e4a18">6.3. Masters</a></li>
<li><a href="#org3c32094">6.4. Nodes</a></li>
<li><a href="#orga82f62a">6.5. Desired State and the Declarative Model</a></li>
<li><a href="#org80b6c1d">6.6. Pods</a></li>
<li><a href="#orgaede28d">6.7. Services</a></li>
<li><a href="#orge9ca52b">6.8. Deployments</a></li>
<li><a href="#orgbbf47c0">6.9. Bringing It Home</a></li>
</ul>
</li>
<li><a href="#orgc0d5dce">7. Installing Kubernetes</a>
<ul>
<li><a href="#orgf9e17ce">7.1. Module Intro</a></li>
<li><a href="#org4740e42">7.2. Minikube</a>
<ul>
<li><a href="#org5c99dc2">7.2.1. mac</a></li>
<li><a href="#org6e8cda2">7.2.2. windows</a></li>
</ul>
</li>
<li><a href="#org078a81f">7.3. Google Container Engine</a></li>
<li><a href="#org6b9a4b7">7.4. Installing in AWS with kops</a></li>
<li><a href="#orgd728ae6">7.5. Installing Manually with kubeadm</a></li>
<li><a href="#org61b7486">7.6. Module Summary</a></li>
</ul>
</li>
<li><a href="#orgc0f9d2f">8. Working with Pods</a>
<ul>
<li><a href="#orgfc7c4be">8.1. Pod Theory</a></li>
<li><a href="#orgb074c15">8.2. Deploying Your First Pod</a></li>
<li><a href="#org345d9b6">8.3. Deploying Pods via Replication Controllers</a></li>
<li><a href="#org4bca942">8.4. Module Summary</a></li>
<li><a href="#orge48e2a8">8.5. Kubernetes Services</a></li>
<li><a href="#orgf174828">8.6. The Theory</a></li>
<li><a href="#org055b443">8.7. Creating a Service the Iterative Way</a></li>
<li><a href="#org14536e1">8.8. Creating a Service the Declarative Way</a></li>
<li><a href="#org3c18c7d">8.9. In the Real World</a></li>
<li><a href="#org77b5068">8.10. Summary</a></li>
</ul>
</li>
<li><a href="#org4481914">9. Kubernetes Deployments</a>
<ul>
<li><a href="#orge1156d7">9.1. Module Intro</a></li>
<li><a href="#org6ef23b0">9.2. Deployment Theory</a></li>
<li><a href="#orgb4f9460">9.3. Creating Your First Kubernetes Deployment</a></li>
<li><a href="#org2dae179">9.4. Updating a Deployment</a></li>
<li><a href="#org6152c21">9.5. Module Summary</a></li>
</ul>
</li>
<li><a href="#orgb6b6bc3">10. What Next?</a>
<ul>
<li><a href="#org0271cdf">10.1. What Next?</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org1c005b0" class="outline-2">
<h2 id="org1c005b0"><span class="section-number-2">1</span> Links</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://app.pluralsight.com/library/courses/getting-started-kubernetes/table-of-contents">https://app.pluralsight.com/library/courses/getting-started-kubernetes/table-of-contents</a>
</p>
</div>
</div>

<div id="outline-container-org217a8de" class="outline-2">
<h2 id="org217a8de"><span class="section-number-2">2</span> Vagrant Lab</h2>
<div class="outline-text-2" id="text-2">
<p>
<a href="https://blog.exxactcorp.com/building-a-kubernetes-cluster-using-vagrant/">https://blog.exxactcorp.com/building-a-kubernetes-cluster-using-vagrant/</a>
</p>


<div class="org-src-container">
<pre class="src src-go">git clone https://exxsyseng@bitbucket.org/exxsyseng/k8s_centos.git      # Centos k8s Cluster
git clone https://exxsyseng@bitbucket.org/exxsyseng/k8s_ubuntu.git      # Ubuntu k8s Cluster
</pre>
</div>
</div>
</div>



<div id="outline-container-org994f280" class="outline-2">
<h2 id="org994f280"><span class="section-number-2">3</span> Course Overview</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgf0edb3d" class="outline-3">
<h3 id="orgf0edb3d"><span class="section-number-3">3.1</span> Course Introduction</h3>
<div class="outline-text-3" id="text-3-1">
<p>
fundamental parts of kubernetes
</p>

<ul class="org-ul">
<li>going to install kubernetes for a lab</li>

<li>going to work with pods</li>

<li>going to do some deployments</li>
</ul>
</div>
</div>
</div>



<div id="outline-container-org3e875b1" class="outline-2">
<h2 id="org3e875b1"><span class="section-number-2">4</span> Course Introduction</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orga99cebf" class="outline-3">
<h3 id="orga99cebf"><span class="section-number-3">4.1</span> Course intro</h3>
</div>
</div>

<div id="outline-container-org03ba636" class="outline-2">
<h2 id="org03ba636"><span class="section-number-2">5</span> What Is Kubernetes?</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgd971d28" class="outline-3">
<h3 id="orgd971d28"><span class="section-number-3">5.1</span> Kubernetes: Where It Came From</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>written in go/golang
<ul class="org-ul">
<li><a href="https://github.com/kubernetes/kubernetes">https://github.com/kubernetes/kubernetes</a></li>
</ul></li>

<li>came from google</li>
<li>borg
<ul class="org-ul">
<li>omega
<ul class="org-ul">
<li>kubernetes</li>
</ul></li>
</ul></li>
</ul>


<p>
Kubernetes = K8s
</p>
</div>
</div>



<div id="outline-container-org08f2fc6" class="outline-3">
<h3 id="org08f2fc6"><span class="section-number-3">5.2</span> Kubernetes: What and Why</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Containers
</p>
<ul class="org-ul">
<li>Challenges they bring
<ul class="org-ul">
<li>brings new scalability challenges</li>

<li>application developers do not care about cpu is running their code</li>

<li>Pets vs Cattle

<ul class="org-ul">
<li>kubernetes, I got this app and it consists of these containers

<ul class="org-ul">
<li>kubernetes take care of all the hard work and logistics</li>
</ul></li>
</ul></li>
</ul></li>
</ul>


<ul class="org-ul">
<li>what is it made up of?

<ul class="org-ul">
<li>standard package format</li>

<li>manifest</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>very platform agnostic

<ul class="org-ul">
<li>as long as you can install the agent, it wil work</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>lets you target deployments

<ul class="org-ul">
<li>it makes decisions about to where to run it</li>
</ul></li>

<li>Kubernetes is moving very fast

<ul class="org-ul">
<li>get your hands dirty and keep playing with it</li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org89ac11a" class="outline-2">
<h2 id="org89ac11a"><span class="section-number-2">6</span> Kubernetes Architecture</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org4652346" class="outline-3">
<h3 id="org4652346"><span class="section-number-3">6.1</span> Module Intro</h3>
<div class="outline-text-3" id="text-6-1">
<p>
Big picture view
</p>

<ul class="org-ul">
<li>masters</li>

<li>nodes</li>

<li>pods[[</li>

<li>Services

<ul class="org-ul">
<li>networking</li>
</ul></li>

<li>deployments</li>
</ul>
</div>
</div>

<div id="outline-container-orgcfc4760" class="outline-3">
<h3 id="orgcfc4760"><span class="section-number-3">6.2</span> Big Picture View</h3>
<div class="outline-text-3" id="text-6-2">
<p>
Kubernetes is just an orchestrator for microservice apps
</p>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200415_193424_e4YYOS.png" alt="kubernetes.org_20200415_193424_e4YYOS.png" />
</p>
</div>

<p>
package up your application and give it to the cluster
</p>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200415_193726_LpcgYX.png" alt="kubernetes.org_20200415_193726_LpcgYX.png" />
</p>
</div>




<ul class="org-ul">
<li>Masters

<ul class="org-ul">
<li>master control plane</li>

<li></li>
</ul></li>

<li>Nodes

<ul class="org-ul">
<li>do the actual work</li>
<li>report back to master about the changes that are happening</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>package the application it up in what is called a deployment

<ul class="org-ul">
<li>manifest file tells cluster what configuration settings it has</li>
</ul></li>
</ul>
</div>
</div>





<div id="outline-container-org74e4a18" class="outline-3">
<h3 id="org74e4a18"><span class="section-number-3">6.3</span> Masters</h3>
<div class="outline-text-3" id="text-6-3">
<p>
platform agnostic
<img src="../../images/kubernetes.org_20200415_194008_jZjkb2.png" alt="kubernetes.org_20200415_194008_jZjkb2.png" />
</p>
<ul class="org-ul">
<li>all it wants is linux
<ul class="org-ul">
<li>linux does not care if it running on bare metal,openstack, cloud</li>
</ul></li>
</ul>


<p>
kube-apiserver
</p>
<ul class="org-ul">
<li>front-end to the control plane</li>
<li>exposes the API (REST)</li>
<li>Consumes JSON via manfiest files
<ul class="org-ul">
<li>declare the state of our app for. record of intent</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>Cluster Store

<ul class="org-ul">
<li>persistent storage</li>
<li>cluster state and con fig</li>
<li>uses etcd
<ul class="org-ul">
<li>source of truth for the cluster</li>
</ul></li>
</ul></li>
</ul>


<ul class="org-ul">
<li>kube controller-manager

<ul class="org-ul">
<li>controller of controllers</li>

<li>node controller</li>

<li>endpoints controller</li>

<li>namespace controller</li>

<li>watches for changes</li>

<li>helps maintain desired state
<ul class="org-ul">
<li>current state = desired state</li>
</ul></li>
</ul></li>

<li>kuber-scheduler

<ul class="org-ul">
<li>watches apiserver for new pods</li>

<li>assigns work to nodes</li>
</ul></li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200415_194815_YRQj8A.png" alt="kubernetes.org_20200415_194815_YRQj8A.png" />
</p>
</div>


<ul class="org-ul">
<li>issuing commands to the master
<ul class="org-ul">
<li>master = api server
<ul class="org-ul">
<li>that is where you are actually issuing commands</li>
</ul></li>
</ul></li>

<li>kubectl talks to the apiserver (master) via json files
<ul class="org-ul">
<li>works gets passed to nodes from the scheduler</li>
</ul></li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200415_195033_dNRDgH.png" alt="kubernetes.org_20200415_195033_dNRDgH.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org3c32094" class="outline-3">
<h3 id="org3c32094"><span class="section-number-3">6.4</span> Nodes</h3>
<div class="outline-text-3" id="text-6-4">
<ul class="org-ul">
<li>kubelet

<ul class="org-ul">
<li>kubelet is the main kubernetes agent on the node (pretty much is the node)

<ul class="org-ul">
<li>talks to containers</li>

<li>registers node with cluster</li>
<li>watches apiserver</li>
<li>instantiates pods</li>
<li>then it reports back the state back to the master
<ul class="org-ul">
<li>kubelet itself does not do anything if something goes wrong, just reports it</li>
</ul></li>

<li>a pod is just a bunch of containers packaged together as a single unit

<ul class="org-ul">
<li>because it is interacting with a container</li>
</ul></li>
</ul></li>

<li>kubelet needs to interact container runtime
<ul class="org-ul">
<li>container runtime examples (pluggable) does not matter which
<ul class="org-ul">
<li>docker</li>
<li>rkt</li>
</ul></li>
</ul></li>
</ul></li>
</ul>


<ul class="org-ul">
<li>kube proxy

<ul class="org-ul">
<li>network brains of the node</li>

<li>makes sure every pod gets it&rsquo;s ip

<ul class="org-ul">
<li>ip per pod</li>

<li>if you want to interface with each container in the pod, you will need to interface with a port</li>
</ul></li>

<li>proxy is also load balances across all pods in a service</li>

<li>bunch of web servers talk to a backend

<ul class="org-ul">
<li>a service will load balance the traffic from a web server pod to a backend pod</li>
</ul></li>
</ul></li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200415_202902_rwb6NU.png" alt="kubernetes.org_20200415_202902_rwb6NU.png" />
</p>
</div>


<p>
wrapup
</p>
<ul class="org-ul">
<li>kubelet</li>
<li>container engine</li>
<li>kube-proxy</li>
</ul>
</div>
</div>


<div id="outline-container-orga82f62a" class="outline-3">
<h3 id="orga82f62a"><span class="section-number-3">6.5</span> Desired State and the Declarative Model</h3>
<div class="outline-text-3" id="text-6-5">
<ul class="org-ul">
<li>kubernetes operates on declarative model

<ul class="org-ul">
<li>YAML or JSON is contains the desired state

<ul class="org-ul">
<li>they are manifest files that describe a record of intent</li>
</ul></li>
</ul></li>
</ul>


<ul class="org-ul">
<li>it&rsquo;s up to kubernetes to get it there at that point
<ul class="org-ul">
<li>pulling images</li>
<li>building networks</li>
<li>starting containers</li>
</ul></li>
</ul>



<div class="figure">
<p><img src="../../images/kubernetes.org_20200415_203208_jDExm4.png" alt="kubernetes.org_20200415_203208_jDExm4.png" />
</p>
</div>


<ul class="org-ul">
<li>example of desired state of a cluster

<ul class="org-ul">
<li>kubernetes control plane runs through reconciliation loops that constantly check if desired state = actual state</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>3 nodes, one pod is running on each of those nodes:</li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200415_203611_C3Fuu0.png" alt="kubernetes.org_20200415_203611_C3Fuu0.png" />
</p>
</div>

<ul class="org-ul">
<li>node goes down</li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200415_203648_ajXxvQ.png" alt="kubernetes.org_20200415_203648_ajXxvQ.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org80b6c1d" class="outline-3">
<h3 id="org80b6c1d"><span class="section-number-3">6.6</span> Pods</h3>
<div class="outline-text-3" id="text-6-6">
<ul class="org-ul">
<li>vmware runs vms</li>
<li>docker runs containers</li>

<li>kubernetes runs pods
<ul class="org-ul">
<li>cannot run a container directly on kubernetes</li>
<li>needs to be running on a pod</li>

<li>typically one container running on a pod but in more advanced configuration you can have more than one container running on a pod</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>what actually is a pod

<ul class="org-ul">
<li>ring-fenced environment</li>

<li><img src="../../images/kubernetes.org_20200415_204247_XeWH4M.png" alt="kubernetes.org_20200415_204247_XeWH4M.png" /></li>
<li>if the use case for containers are tightly coupled and need access to the same resources

<ul class="org-ul">
<li>stick them in the same pod</li>

<li><img src="../../images/kubernetes.org_20200415_204413_q0l134.png" alt="kubernetes.org_20200415_204413_q0l134.png" /></li>

<li>if the use case can be loosely coupled, stick them in separate pods in couple them over the networks</li>

<li><img src="../../images/kubernetes.org_20200415_204539_t4x81j.png" alt="kubernetes.org_20200415_204539_t4x81j.png" /></li>

<li>the unit of scaling in kube is the pod

<ul class="org-ul">
<li>you want to scale an app? you would add/remove pods</li>

<li>you don&rsquo;t scale by adding more containers to an existing pod
<ul class="org-ul">
<li>add/remove pod replicas</li>
</ul></li>

<li><img src="../../images/kubernetes.org_20200415_204709_iAeHa3.png" alt="kubernetes.org_20200415_204709_iAeHa3.png" /></li>
</ul></li>
</ul></li>

<li>example of a multi-container pod

<ul class="org-ul">
<li>two or more complimentary containers
<ul class="org-ul">
<li>web server and log scraper tailing logs off somewhere else</li>

<li><img src="../../images/kubernetes.org_20200415_205121_fc31Rc.png" alt="kubernetes.org_20200415_205121_fc31Rc.png" /></li>

<li><img src="../../images/kubernetes.org_20200415_205155_iwHUeu.png" alt="kubernetes.org_20200415_205155_iwHUeu.png" />

<ul class="org-ul">
<li>web server = main</li>
<li>log scraper = sidecar</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>

<li>pods are atomic

<ul class="org-ul">
<li>it is either not there or there
<ul class="org-ul">
<li>no state that it is in the process of coming up</li>
<li>pod is not declared available until the whole pod is up and running</li>
</ul></li>

<li>you cannot have a single pod spread over multiple nodes</li>

<li>pods&rsquo;s life cycle

<ul class="org-ul">
<li>they are born, live and die. you don&rsquo;t bring one back to life</li>

<li><img src="../../images/kubernetes.org_20200415_205509_7BGlRp.png" alt="kubernetes.org_20200415_205509_7BGlRp.png" /></li>

<li>this is consistent with pet vs cattle. when pods die, a totally new one can pop up in it&rsquo;s place and replace it</li>
</ul></li>

<li>pod deployments

<ul class="org-ul">
<li>replace replication controllers</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgaede28d" class="outline-3">
<h3 id="orgaede28d"><span class="section-number-3">6.7</span> Services</h3>
<div class="outline-text-3" id="text-6-7">
<ul class="org-ul">
<li>pods die and come back up somewhere else in the cluster (on a different node possibly)

<ul class="org-ul">
<li>example of how IP address churn is addressed</li>

<li>say pods running apps need access to pods running databases
<ul class="org-ul">
<li>ips changing constantly. lose and gain when you scale</li>
</ul></li>

<li>this is where services come to play</li>

<li>provides a single dns name and IP here so that the pods IP have nothing to do with it</li>
<li><img src="../../images/kubernetes.org_20200415_210400_X7Jizk.png" alt="kubernetes.org_20200415_210400_X7Jizk.png" /></li>

<li>if a pod dies and replaces itself, service updates and knows about it</li>

<li>example of this happening is when the pods are being updated to a new version, can auto scale from 2 to 4 and back to two as easy as that</li>
</ul></li>

<li>labels

<ul class="org-ul">
<li>labeled BE pods with relevant information, the labels tie the pod to the service</li>

<li><img src="../../images/kubernetes.org_20200415_210806_yR1gZf.png" alt="kubernetes.org_20200415_210806_yR1gZf.png" /></li>

<li>when we are updating can remove the tag on the service that makes it exclusive to servicing one version</li>

<li><img src="../../images/kubernetes.org_20200415_210929_ZDY4Ij.png" alt="kubernetes.org_20200415_210929_ZDY4Ij.png" />

<ul class="org-ul">
<li>load balancing across them all until we are ready to be fully on the new version</li>
</ul></li>

<li><img src="../../images/kubernetes.org_20200415_211024_HEbPA3.png" alt="kubernetes.org_20200415_211024_HEbPA3.png" /></li>

<li>services only send traffic to healthy pods</li>

<li>can configure the service to point to things outside the cluster</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orge9ca52b" class="outline-3">
<h3 id="orge9ca52b"><span class="section-number-3">6.8</span> Deployments</h3>
<div class="outline-text-3" id="text-6-8">
<ul class="org-ul">
<li>our infrastructure = masters and nodes
<ul class="org-ul">
<li><img src="../../images/kubernetes.org_20200415_211946_63N0dm.png" alt="kubernetes.org_20200415_211946_63N0dm.png" /></li>

<li>pods are running on the nodes</li>
</ul></li>

<li>deployments = declarativeness

<ul class="org-ul">
<li>declare through the manfiest yml or json files</li>

<li>self documenting, versioned, spec-once deploy many</li>

<li>makes for much simpler rollbacks and rolling updates</li>

<li>the declaration is deployed by kube via the apiserver</li>
</ul></li>

<li>rolling updates

<ul class="org-ul">
<li>can run multiple concurrent versions</li>

<li>blue-green deployments</li>
<li>canary releases</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgbbf47c0" class="outline-3">
<h3 id="orgbbf47c0"><span class="section-number-3">6.9</span> Bringing It Home</h3>
<div class="outline-text-3" id="text-6-9">
<ul class="org-ul">
<li>just give us linux, we&rsquo;ll give you kubernetes</li>
<li>master node setup</li>

<li>master (control plane
<ul class="org-ul">
<li>apiserver</li>
<li>cluster store
<ul class="org-ul">
<li>api server talks to it</li>
</ul></li>
</ul></li>

<li>node/minion

<ul class="org-ul">
<li>where the work happens</li>

<li>kubelet</li>
<li>container engine</li>
<li>kube-proxy</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>example

<ul class="org-ul">
<li>issue work to master via api server (instruction = manifest files)</li>

<li>master decides where to run the work

<ul class="org-ul">
<li>gets dished out to the worker nodes</li>

<li>they report back state changes to the master</li>
</ul></li>
</ul></li>
</ul>


<ul class="org-ul">
<li>rest objects in kubernets api
<ul class="org-ul">
<li>pods
<ul class="org-ul">
<li>atomic unit of scheduling</li>
</ul></li>
<li>replication controllers
<ul class="org-ul">
<li>old</li>
</ul></li>

<li>deployments
<ul class="org-ul">
<li>RC, rolling updates, rollbacks</li>
</ul></li>

<li>services
<ul class="org-ul">
<li>stable networking</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgc0d5dce" class="outline-2">
<h2 id="orgc0d5dce"><span class="section-number-2">7</span> Installing Kubernetes</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orgf9e17ce" class="outline-3">
<h3 id="orgf9e17ce"><span class="section-number-3">7.1</span> Module Intro</h3>
<div class="outline-text-3" id="text-7-1">
<p>
going to use minikube
</p>
<ul class="org-ul">
<li>cerner dailyprogrammer uses kind</li>
</ul>
</div>
</div>

<div id="outline-container-org4740e42" class="outline-3">
<h3 id="org4740e42"><span class="section-number-3">7.2</span> Minikube</h3>
<div class="outline-text-3" id="text-7-2">
</div>
<div id="outline-container-org5c99dc2" class="outline-4">
<h4 id="org5c99dc2"><span class="section-number-4">7.2.1</span> mac</h4>
<div class="outline-text-4" id="text-7-2-1">
<div class="org-src-container">
<pre class="src src-go">brew install kubectl
kubectl --version
</pre>
</div>

<div class="org-src-container">
<pre class="src src-go">brew cask install minikube
</pre>
</div>
</div>
</div>

<div id="outline-container-org6e8cda2" class="outline-4">
<h4 id="org6e8cda2"><span class="section-number-4">7.2.2</span> windows</h4>
<div class="outline-text-4" id="text-7-2-2">
<p>
<a href="https://technology.amis.nl/2019/02/12/rapidly-spinning-up-a-vm-with-ubuntu-docker-and-minikube-using-the-vm-drivernone-option-on-my-windows-laptop-using-vagrant-and-oracle-virtualbox/">https://technology.amis.nl/2019/02/12/rapidly-spinning-up-a-vm-with-ubuntu-docker-and-minikube-using-the-vm-drivernone-option-on-my-windows-laptop-using-vagrant-and-oracle-virtualbox/</a>
</p>

<p>
go straight to here:
</p>

<p>
Please click for: Vagrantfile
Please click for: docker.sh
Please click for: minikube.sh
Please click for: kubectl.sh
</p>


<div class="org-src-container">
<pre class="src src-go">vagrant up
</pre>
</div>

<p>
<a href="http://127.0.0.1:8001/api/v1/namespaces/kube-system/services/http:kubernetes-dashboard:/proxy/">http://127.0.0.1:8001/api/v1/namespaces/kube-system/services/http:kubernetes-dashboard:/proxy/</a>
</p>
</div>
</div>
</div>

<div id="outline-container-org078a81f" class="outline-3">
<h3 id="org078a81f"><span class="section-number-3">7.3</span> Google Container Engine</h3>
<div class="outline-text-3" id="text-7-3">
<p>
n/a
</p>
</div>
</div>
<div id="outline-container-org6b9a4b7" class="outline-3">
<h3 id="org6b9a4b7"><span class="section-number-3">7.4</span> Installing in AWS with kops</h3>
<div class="outline-text-3" id="text-7-4">
<p>
n/a
</p>
</div>
</div>
<div id="outline-container-orgd728ae6" class="outline-3">
<h3 id="orgd728ae6"><span class="section-number-3">7.5</span> Installing Manually with kubeadm</h3>
<div class="outline-text-3" id="text-7-5">
<p>
n/a
</p>
</div>
</div>
<div id="outline-container-org61b7486" class="outline-3">
<h3 id="org61b7486"><span class="section-number-3">7.6</span> Module Summary</h3>
<div class="outline-text-3" id="text-7-6">
<ul class="org-ul">
<li>smallest unit of scheduling is a pod (atomic)</li>

<li>pod manfests (yaml or JSON)</li>

<li>deployed via other objects
<ul class="org-ul">
<li>replication controllers etc</li>
</ul></li>

<li>replication controllers
<ul class="org-ul">
<li>implement desired state</li>
</ul></li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgc0f9d2f" class="outline-2">
<h2 id="orgc0f9d2f"><span class="section-number-2">8</span> Working with Pods</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orgfc7c4be" class="outline-3">
<h3 id="orgfc7c4be"><span class="section-number-3">8.1</span> Pod Theory</h3>
<div class="outline-text-3" id="text-8-1">
<ul class="org-ul">
<li>VM = Container in the docker world
<ul class="org-ul">
<li>kubernetes = pods are the atomic unit of scheduling</li>
</ul></li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200418_181935_M8nSpF.png" alt="kubernetes.org_20200418_181935_M8nSpF.png" />
</p>
</div>

<ul class="org-ul">
<li>deploy a pod to a cluster by giving it a manifest file
<ul class="org-ul">
<li>api server deploys it to a node</li>
</ul></li>
</ul>



<div class="figure">
<p><img src="../../images/kubernetes.org_20200418_182037_nDoMNC.png" alt="kubernetes.org_20200418_182037_nDoMNC.png" />
</p>
</div>

<ul class="org-ul">
<li>pod gets one IP
<ul class="org-ul">
<li>one IP for each pod</li>
<li>access each container by the port
<ul class="org-ul">
<li>each ip is it&rsquo;s own network namespace</li>
<li>each container needs to be accessed on it&rsquo;s own port. two containers cannot share the same port</li>
</ul></li>
</ul></li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200418_182316_Pvj4kb.png" alt="kubernetes.org_20200418_182316_Pvj4kb.png" />
</p>
</div>

<ul class="org-ul">
<li>interpod communication
<ul class="org-ul">
<li>every pod talk to every other pod</li>
</ul></li>
</ul>

<div class="figure">
<p><img src="../../images/kubernetes.org_20200418_182400_5rUGA9.png" alt="kubernetes.org_20200418_182400_5rUGA9.png" />
</p>
</div>


<ul class="org-ul">
<li>intra-pod communication (within the pod)</li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200418_182454_73XXGe.png" alt="kubernetes.org_20200418_182454_73XXGe.png" />
</p>
</div>


<ul class="org-ul">
<li>no such thing as a half deployed
<ul class="org-ul">
<li>pod cannot be parcially up</li>
</ul></li>

<li>one pod : one node
<ul class="org-ul">
<li>cannot have a pod on two nodes</li>
</ul></li>

<li>you can more than oen container on one pod though</li>

<li>scheduled on nodes (monions)</li>

<li>pod lifecycle
<ul class="org-ul">
<li>manifest -&gt; api server
<ul class="org-ul">
<li>pod pending state
<ul class="org-ul">
<li>pod -&gt; running state
<ul class="org-ul">
<li>pod either succeeds</li>
<li>pod failed</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200418_182719_KCcaeg.png" alt="kubernetes.org_20200418_182719_KCcaeg.png" />
</p>
</div>
</div>
</div>







<div id="outline-container-orgb074c15" class="outline-3">
<h3 id="orgb074c15"><span class="section-number-3">8.2</span> Deploying Your First Pod</h3>
<div class="outline-text-3" id="text-8-2">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 5: </span>pod.yml</label><pre class="src src-go">apiVersion: v1
kind: Pod
metadata:
  name: hello-pod
spec:
  containers:
  - name: hello-ctr
    image: nigelpoulton/pluralsight-docker-cilatest
    ports:
    - containerPort: 8080
</pre>
</div>

<ul class="org-ul">
<li>setting the api version</li>
<li>setting what kind of object to deploy</li>
<li>setting the name of the pod</li>
<li>spec is setting what is in the resource
<ul class="org-ul">
<li>naming the image and specifying the imae</li>
<li>if it is going to be a multi-container pod would just set more up down below this section</li>
</ul></li>
</ul>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 6: </span>creating the pod</label><pre class="src src-shell">vagrant@ubuntu-xenial:~$ kubectl create -f pod.yml
pod/hello-pod created


vagrant@ubuntu-xenial:~$ kubectl get pods
NAME        READY   STATUS              RESTARTS   AGE
hello-pod   0/1     ContainerCreating   0          2s

vagrant@ubuntu-xenial:~$ kubectl get pods
NAME        READY   STATUS    RESTARTS   AGE
hello-pod   1/1     Running   0          25s
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 7: </span>filter when getting pods</label><pre class="src src-shell">kubectl get pods/hello-pod
</pre>
</div>


<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 8: </span>get all pods in all namespaces</label><pre class="src src-shell">kubetl get pods --all-namespaces
</pre>
</div>

<ul class="org-ul">
<li>we do not typicall manage pods like this though</li>

<li>assume you wanted 5 instances of a pod, and wanted the desired state to be that way</li>
</ul>

<div class="figure">
<p><img src="../../images/kubernetes.org_20200418_184703_zV5rBP.png" alt="kubernetes.org_20200418_184703_zV5rBP.png" />
</p>
</div>

<ul class="org-ul">
<li>kubernetes makes sure it always stays that way</li>
</ul>
</div>
</div>






<div id="outline-container-org345d9b6" class="outline-3">
<h3 id="org345d9b6"><span class="section-number-3">8.3</span> Deploying Pods via Replication Controllers</h3>
<div class="outline-text-3" id="text-8-3">
<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 9: </span>rc.yml</label><pre class="src src-yml">apiVersion: v1
kind: ReplicationController
metadata:
  name: hello-rc
spec:
  replicas: 10
  selector:
    app: hello-world
  template:
    metadata:
      labers:
	app: hello-world
  containers:
    - name:
      image: nigelpoulton/pluralsight-docker-ci:latest
      ports:
      - containerPort: 8080
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 10: </span>create what you just made</label><pre class="src src-go">kubectl create -f rc.yml
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 11: </span>upp the amount of instances</label><pre class="src src-yml">&lt;change rc.yml&gt;

vagrant@ubuntu-xenial:~$ kubectl apply -f rc.yml
Warning: kubectl apply should be used on resource created by either kubectl create --save-config or kubectl apply
replicationcontroller/hello-rc configured
</pre>
</div>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 12: </span>see that it is 20 now</label><pre class="src src-go">vagrant@ubuntu-xenial:~$ kubectl get pods              
NAME             READY   STATUS    RESTARTS   AGE      
hello-rc-2tqmt   1/1     Running   0          5m36s    
hello-rc-54q76   1/1     Running   0          5m36s    
hello-rc-7bpdg   1/1     Running   0          5m36s    
hello-rc-7kk4c   1/1     Running   0          7m28s    
hello-rc-8kmkc   1/1     Running   0          5m36s    
hello-rc-cj99d   1/1     Running   0          7m28s    
hello-rc-fbffc   1/1     Running   0          7m28s    
hello-rc-jbjlz   1/1     Running   0          5m36s    
hello-rc-jnxc5   1/1     Running   0          5m36s    
hello-rc-k59v6   1/1     Running   0          7m28s    
hello-rc-k5grr   1/1     Running   0          7m28s    
hello-rc-l4nst   1/1     Running   0          7m28s    
hello-rc-mlsrl   1/1     Running   0          5m36s    
hello-rc-pf9s8   1/1     Running   0          5m36s    
hello-rc-qd5zp   1/1     Running   0          7m28s    
hello-rc-rb262   1/1     Running   0          5m36s    
hello-rc-rhfhv   1/1     Running   0          7m28s    
hello-rc-vzvzr   1/1     Running   0          7m28s    
hello-rc-x72kl   1/1     Running   0          5m36s    
hello-rc-zksnl   1/1     Running   0          7m28s    
</pre>
</div>
</div>
</div>

<div id="outline-container-org4bca942" class="outline-3">
<h3 id="org4bca942"><span class="section-number-3">8.4</span> Module Summary</h3>
<div class="outline-text-3" id="text-8-4">
<ul class="org-ul">
<li>theory of services</li>

<li>create a service the iterative way</li>

<li>create a serice the decalairtive way</li>

<li>real-world application</li>

<li>recap</li>
</ul>
</div>
</div>
<div id="outline-container-orge48e2a8" class="outline-3">
<h3 id="orge48e2a8"><span class="section-number-3">8.5</span> Kubernetes Services</h3>
<div class="outline-text-3" id="text-8-5">
<ul class="org-ul">
<li>services are rest objects in the K8s API
<ul class="org-ul">
<li>services are an abstraction</li>
<li>services = reliable
<ul class="org-ul">
<li>pods are not</li>
</ul></li>
</ul></li>

<li>we have no solid way of connecting to the pods right now
<ul class="org-ul">
<li><img src="../../images/kubernetes.org_20200418_190633_51bw9l.png" alt="kubernetes.org_20200418_190633_51bw9l.png" />

<ul class="org-ul">
<li>service gets it&rsquo;s own IP in the middle that never changes</li>
</ul></li>

<li>no matter what is changing on the replication controller, the service accomodates it</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>you can hit any of the nodes in the cluster on the port that the container is running on:

<ul class="org-ul">
<li><img src="../../images/kubernetes.org_20200418_191019_cZheVp.png" alt="kubernetes.org_20200418_191019_cZheVp.png" /></li>

<li>whatever comes in or leaves, the service keeps an endpoint directory</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>labels</li>
</ul>


<div class="figure">
<p><img src="../../images/kubernetes.org_20200418_191202_o29yew.png" alt="kubernetes.org_20200418_191202_o29yew.png" />
</p>
</div>

<ul class="org-ul">
<li>tell the service to look at the label of the pods
<ul class="org-ul">
<li>version label specifically</li>
</ul></li>
</ul>


<ul class="org-ul">
<li>service discovery

<ul class="org-ul">
<li>DNS based (best)
<ul class="org-ul">
<li>makes sure kubeletes (nodes) can be found</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgf174828" class="outline-3">
<h3 id="orgf174828"><span class="section-number-3">8.6</span> The Theory</h3>
</div>


<div id="outline-container-org055b443" class="outline-3">
<h3 id="org055b443"><span class="section-number-3">8.7</span> Creating a Service the Iterative Way</h3>
<div class="outline-text-3" id="text-8-7">
<ul class="org-ul">
<li>going to create a service</li>
</ul>

<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 13: </span>creating a service</label><pre class="src src-go">vagrant@ubuntu-xenial:~$ kubectl expose rc hello-rc --name=hello-svc  --target-port=8080 --type=NodePort
service/hello-svc exposed


vagrant@ubuntu-xenial:~$ kubectl describe svc hello-svc
Name:                     hello-svc
Namespace:                default
Labels:                   app=hello-world
Annotations:              &lt;none&gt;
Selector:                 app=hello-world
Type:                     NodePort
IP:                       10.102.123.13
Port:                     &lt;unset&gt;  8080/TCP
TargetPort:               8080/TCP
NodePort:                 &lt;unset&gt;  31894/TCP
Endpoints:                172.17.0.10:8080,172.17.0.11:8080,172.17.0.12:8080 + 17 more...
Session Affinity:         None
External Traffic Policy:  Cluster
Events:                   &lt;none&gt;

</pre>
</div>
</div>
</div>





<div id="outline-container-org14536e1" class="outline-3">
<h3 id="org14536e1"><span class="section-number-3">8.8</span> Creating a Service the Declarative Way</h3>
</div>


<div id="outline-container-org3c18c7d" class="outline-3">
<h3 id="org3c18c7d"><span class="section-number-3">8.9</span> In the Real World</h3>
</div>


<div id="outline-container-org77b5068" class="outline-3">
<h3 id="org77b5068"><span class="section-number-3">8.10</span> Summary</h3>
</div>
</div>


<div id="outline-container-org4481914" class="outline-2">
<h2 id="org4481914"><span class="section-number-2">9</span> Kubernetes Deployments</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-orge1156d7" class="outline-3">
<h3 id="orge1156d7"><span class="section-number-3">9.1</span> Module Intro</h3>
</div>


<div id="outline-container-org6ef23b0" class="outline-3">
<h3 id="org6ef23b0"><span class="section-number-3">9.2</span> Deployment Theory</h3>
</div>


<div id="outline-container-orgb4f9460" class="outline-3">
<h3 id="orgb4f9460"><span class="section-number-3">9.3</span> Creating Your First Kubernetes Deployment</h3>
</div>


<div id="outline-container-org2dae179" class="outline-3">
<h3 id="org2dae179"><span class="section-number-3">9.4</span> Updating a Deployment</h3>
</div>


<div id="outline-container-org6152c21" class="outline-3">
<h3 id="org6152c21"><span class="section-number-3">9.5</span> Module Summary</h3>
</div>
</div>


<div id="outline-container-orgb6b6bc3" class="outline-2">
<h2 id="orgb6b6bc3"><span class="section-number-2">10</span> What Next?</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-org0271cdf" class="outline-3">
<h3 id="org0271cdf"><span class="section-number-3">10.1</span> What Next?</h3>
<div class="outline-text-3" id="text-10-1">

<div class="figure">
<p><img src="../../images/kubernetes.org_20200418_143658_tLYQXO.png" alt="kubernetes.org_20200418_143658_tLYQXO.png" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: EVAN-PC</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
